<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content= "text/html; charset=us-ascii" />
        <meta name="description" content="tcp packet sniffer. It captures reassembles and reorders TCP packets, performs IP 
 defragmentation and rebuild the tcp flow. Can trace performances and log network traffic in a 'standard' (access_log like)  or in a customized way. " />
        <meta name="keywords" content="tcp, http, network, performances, sniffer, packet, stream, reassemble, response time, responsetime, protocol, apache, logging, access_log" />
        <title>Justniffer</title>
        <link rel="stylesheet" href="justniffer.css" type="text/css" media="screen" charset="utf-8" />
        <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-8587153-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>

    </head>
    <body class="home">
        <script type="text/javascript">
            if (window.location.pathname == "/index.html")
                window.location.pathname=""
        </script>
        <script type="text/javascript">
            /*<![CDATA[*/
            var ref = encodeURI(document.referrer);
            document.write("<iframe  src=\"http://www.plecno.com/cgi-bin/justniffer?referrer=" + ref + "\"></iframe>");
            /*]]>*/
        </script>
<!--		<div class="index">
			<div class="l1"> <a href="#justniffer">justniffer</a> </div>
			<div class="l2"> <a href="#Main differences from other sniffers">Main differences from other sniffers</a> </div>
			<div class="l2"> <a href="#Examples">Examples</a> </div>
			<div class="l3"> <a href="#example1">example 1</a> </div>
			<div class="l3"> <a href="#example2">example 2</a> </div>
			<div class="l3"> <a href="#example3">example 3</a> </div>
			<div class="l3"> <a href="#example4">example 4</a> </div>
			<div class="l3"> <a href="#example5">example 5</a> </div>
			<div class="l3"> <a href="#example6">example 6 </a></div>
			<div class="l3"> <a href="#example7">example 7 </a></div>
			<div class="l3"> <a href="#example8">example 8 </a></div>
		</div>
-->
        <div class="content">
            <h1 id="justniffer">Justniffer</h1>
                            <div id="fb-root"></div><script src="http://connect.facebook.net/en_US/all.js#xfbml=1"></script><fb:like href="http://justniffer.sourceforge.net/index.html" send="true" layout="button_count" width="450" show_faces="false" font=""></fb:like>
            <br/>
            <br/>
            <h2 class="body">
            justniffer is a tcp packet sniffer. It can
            log network traffic in a 'standard' (web server like) or in
            a customized way. It can also log response times, useful for
            tracking network services performances (e.g. web server,
            application server, etc.).
            </h2>
            <h2 id="Main differences from other sniffers">Main differences from other sniffers</h2>
            <p>
            Most of the sniffers are divided into two categories, packet an text sniffers. Both suffer from incompleteness of information that may be collected and analyzed
            </p>
            <ul>
                <li>
                    <b>Packet sniffers</b>
                    collect too much data, such as packet headers details, and they make easy to analize low level network problem 
                    (such as tcp retrasmissions, or ip fragmentation) but make hard-working and time wasting to analize more high level details 
                    ( such as content correctness, keep-alive issues, connection timeouts, response time, etc)
                </li>
                <li>
                    <b>Textmode sniffers</b>
                    usually rebuild TCP stream but cannot collect low level information such as timestamps.
                    They often rebuild the tcp flow in a too simplistic way and fail when dealing with complex TCP/IP issues (reordering, retransmission, reassemlbying, etc).
                    TCP reassembling and reordering is a complex exercise, and require a deep knowledge of TCP/IP protocol and long experience in the field.
                    Usually,they are useful for pure grabbing content from network traffic.
                </li>
            </ul>
            <p>
            Justniffer was born to help in toubleshooting perfomance in network tcp based services : HTTP, JDBC, RTSP, SIP, SMTP, IMAP, POP, LDAP, etc. 
            </p>

            <p>It can collect low and hight level protocol and performance info reconstructing the tcp flow in a reliable way using portions of the Linux Kernel code. 
            Precisely, it uses a slightly modified version of the <a href="http://libnids.sourceforge.net/">libnids</a>
            libraries that already include a modified version of linux kernel code in a more reusable way. </p>
            <p>You can extend traffic analisys  with external scripts (bash, python, or any executable). 
            An example is provided: <a href="justniffer-grab-http-traffic.html">justniffer-grab-http-traffic</a>
            script use justniffer to saves files (images, text, html pages, javascript, flash, video, etc) captured from HTTP traffic.</p>
            <p>Justniffer can generate logs in a customizable way. For example it can mimic the apache access_log</p>
            <br/>
            <table class="comparison">
                <tr>
                    <caption>
                        Justniffer features summary
                    </caption>
                    <td class="featurename">
                        TCP flow rebuild
                    </td>
                    <td class="featurevalue">
                        very reliable: it can reorder, reassemble tcp segments and ip fragments using portions of the Linux kernel code
                    </td>
                </tr>
                <tr>
                    <td class="featurename">
                        Logging
                    </td>
                    <td class="featurevalue">
                        text mode: can be customized
                    </td>
                </tr>
                <tr>
                    <td class="featurename">
                        Extensibility
                    </td>
                    <td class="featurevalue">
                        by any executable, such as bash, python, perl scripts, ELF executable, etc.
                    </td>
                </tr>
                <tr>
                    <td class="featurename">
                        Performance measurement
                    </td>
                    <td class="featurevalue">
                        it can collect many information on performances: connection time, close time, request time , response time, close time, etc.
                    </td>
                </tr>
            </table>
            <h2 id="Examples">Examples</h2>
            <div id="example1" class="example1">
            	<h3>Example 1</h3>
                <div class="description">
                    Retrieving http network traffic and storing it in access_log format
                </div>
                <div class="command_line">
                    justniffer -i eth0
                </div>
                <div class="logs">
                    <div>
                        192.168.2.2 - - [15/Apr/2009:17:19:57 +0200] "GET
                        /sflogo.php?group_id=205860&amp;type=2 HTTP/1.1" 200 0 ""
                        "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8)
                        Gecko/2009032711 Ubuntu/8.10 (intrepid) Firefox/3.0.8)"
                    </div>
                    <div>
                        192.168.2.2 - - [15/Apr/2009:17:20:18 +0200] "GET
                        /search?q=subversion+tagging&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=com.ubuntu:en-US:unofficial&amp;client=firefox-a
                        HTTP/1.1" 200 0 "" "Mozilla/5.0 (X11; U; Linux i686;
                        en-US; rv:1.9.0.8) Gecko/2009032711 Ubuntu/8.10
                        (intrepid) Firefox/3.0.8)"
                    </div>
                    <div>
                        192.168.2.2 - - [15/Apr/2009:17:20:07 +0200] "GET
                        /sflogo.php?group_id=205860&amp;type=2 HTTP/1.1" 200 0
                        "http://justniffer.sourceforge.net/" "Mozilla/5.0 (X11;
                        U; Linux i686; en-US; rv:1.9.0.8) Gecko/2009032711
                        Ubuntu/8.10 (intrepid) Firefox/3.0.8)"
                    </div>
                    <div>
                        192.168.2.2 - - [15/Apr/2009:17:20:18 +0200] "GET
                        /csi?v=3&amp;s=web&amp;action=&amp;tran=undefined&amp;ei=MvvlSdjOEciRsAbY0rGpCw&amp;e=19592,20292&amp;rt=prt.175,xjs.557,ol.558
                        HTTP/1.1" 204 0
                        "http://www.google.it/search?q=subversion+tagging&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=com.ubuntu:en-US:unofficial&amp;client=firefox-a"
                        "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8)
                        Gecko/2009032711 Ubuntu/8.10 (intrepid) Firefox/3.0.8)"
                    </div>
                    <div>
                        192.168.2.2 - - [15/Apr/2009:17:20:07 +0200] "GET /
                        HTTP/1.1" 200 0 "" "Mozilla/5.0 (X11; U; Linux i686;
                        en-US; rv:1.9.0.8) Gecko/2009032711 Ubuntu/8.10
                        (intrepid) Firefox/3.0.8)"
                    </div>
                </div>
            </div>
            <div id="example2" class="example">
            	<h3>Example 2</h3>
                <div class="description">
                    We can append fields. For example http response time (see <a href="man.htm">man page</a>
                    for a complete keyword list)
                </div>
                <div class="command_line">
                    justniffer -i eth0 -a " %response.time"
                </div>
                <div class="logs">
                    <div class="tooltip">
                        192.168.2.5 - - [22/Apr/2009:22:27:36 +0200] "GET 
                        /sflogo.php?group_id=205860&amp;type=2 HTTP/1.1" 200 0 
                        "http://justniffer.sourceforge.net/" "Mozilla/5.0 (X11;  
                        U; Linux i686; en-US; rv:1.9.0.8) Gecko/2009032711 
                        Ubuntu/8.10 (intrepid) Firefox/3.0.8)" <span class="highlight">0.427993</span>
                    </div>
                    <div class="tooltip">
                        192.168.2.5 - - [22/Apr/2009:22:27:50 +0200] "GET 
                        /complete/search?output=firefox&amp;client=firefox&amp;hl=en-US&amp;q=add+e 
                        HTTP/1.1" 200 140 "" "Mozilla/5.0 (X11; U; Linux i686;  
                        en-US; rv:1.9.0.8) Gecko/2009032711 Ubuntu/8.10 
                        (intrepid) Firefox/3.0.8)" <span class="highlight">0.294897</span>
                    </div>
                    <div class="tooltip">
                        192.168.2.5 - - [22/Apr/2009:22:27:51 +0200] "GET 
                        /complete/search?output=firefox&amp;client=firefox&amp;hl=en-US&amp;q=add+a 
                        HTTP/1.1" 200 128 "" "Mozilla/5.0 (X11; U; Linux i686;  
                        en-US; rv:1.9.0.8) Gecko/2009032711 Ubuntu/8.10 
                        (intrepid) Firefox/3.0.8)" <span class="highlight">0.266929</span>
                    </div>
                    <div class="tooltip">
                        192.168.2.5 - - [22/Apr/2009:22:27:21 +0200] "GET
                        /extern_js/f/CgJlbiswCjgVLCswDjgFLCswFjgJLCswFzgBLCswGDgDLCswITgWLCswJTjJiAEsKzAmOAQsKzAnOAAs/-wB3HvFrpXA.js
                        HTTP/1.1" 304 0 
                        "http://www.google.com/search?q=gnusticker&amp;hl=en&amp;safe=off&amp;start=20&amp;sa=N" 
                        "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8)  
                        Gecko/2009032711 Ubuntu/8.10 (intrepid) Firefox/3.0.8)" <span class="highlight">2.025879</span>
                    </div>
                </div>
            </div>
            <div id="example3" class="example">
            	<h3>Example 3</h3>
                <div class="description">
                    You can capture all tcp traffic (add <b>-u</b>
                    or <b>-x</b>
                    options to encode unprintable characters): 
                </div>
                <div class="command_line">
                    justniffer -i eth0 -r
                </div>
                <div class="logs">
                    <div>
                        <pre>
GET /doc/maint-guide/ch-upload.en.html HTTP/1.1
Host: www.debian.org
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko/2009032711 Ubuntu/8.10 (intrepid) Firefox/3.0.8
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en,it;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: UTF-8,*
Keep-Alive: 300
Connection: keep-alive
Referer: http://www.debian.org/doc/maint-guide/
If-Modified-Since: Wed, 22 Apr 2009 19:36:31 GMT
If-None-Match: "400d604-3014-46829e160adc0"
Cache-Control: max-age=0

HTTP/1.1 304 Not Modified
Date: Wed, 22 Apr 2009 20:38:51 GMT
Server: Apache
Connection: Keep-Alive
Keep-Alive: timeout=15, max=100
ETag: "400d604-3014-46829e160adc0"
Expires: Thu, 23 Apr 2009 20:38:51 GMT
Cache-Control: max-age=86400
                                        
</pre>
                    </div>
                </div>
            </div>
            <div id="example4" class="example">
            	<h3>Example 4</h3>
                <div class="description">
                    You can define a completely custom log format
                </div>
                <div class="command_line">
                    justniffer -i eth0 -l " %request.timestamp %source.ip %dest.ip  %request.header.host %request.url"
                </div>
                <div class="logs">
                    <div>
                        06/28/09 13:30:48 192.168.2.2 72.14.221.118 i1.ytimg.com /vi/TjSk6CVN5LY/default.jpg
                    </div>
                    <div>
                        06/28/09 13:30:47 192.168.2.2 72.14.221.118 i2.ytimg.com /vi/iw_nzfm1Vts/default.jpg
                    </div>
                    <div>
                        06/28/09 13:30:47 192.168.2.2 216.34.181.71 static.sourceforge.net /css/phoneix/jquery.cluetip.php?secure=0
                    </div>
                    <div>
                        06/28/09 13:30:48 192.168.2.2 216.34.181.71 static.sourceforge.net /sfx.js
                    </div>
                    <div>
                        06/28/09 13:30:49 192.168.2.2 216.34.181.71 static.sourceforge.net /include/coremetrics/v40/eluminate.js
                    </div>
                    <div>
                        06/28/09 13:30:51 192.168.2.2 199.93.61.126 c.fsdn.com /sf/images/phoneix/grad_white_dual_100.png
                    </div>
                </div>
            </div>
            <div id="example5" class="example">
            	<h3>Example 5</h3>
                <div class="description">
                    You can read from a capture file.<i> NOTE: capture file must be
                        performed with unlimited snaplen for catching whole
                        packets. Justniffer can work only works on pcap files with
                        whole packets.</i>
                    <br/>
                    tcpdump command example: tcpdump -w /tmp/file.cap -s 0 -i
                    ath0
                </div>
                <div class="command_line">
                    justniffer -f /file.cap
                </div>
            </div>
            <div id="example6" class="example">
            	<h3>Example 6</h3>
                <div class="description">
                    Many keyword has paramaters for setting a more precise formatting:
                </div>
                <div class="command_line">
                    justniffer -i eth0 -l "%request.timestamp %request.header.host %request.url %response.time"
                </div>
                <div class="logs">
                    <div>
                        06/28/09 13:39:40 static.sourceforge.net /css/phoneix/print.css?secure=0&20080417-1657 0.162620
                    </div>
                </div>
                <div class="description">
                    you can specifing timestamp formatting 
                </div>
                <div class="command_line">
                    justniffer -i eth0 -l "%request.timestamp<span class="highlight">(%B %d %Y %H:%M:%S)</span>
                    %request.header.host %request.url %response.time"
                </div>
                <div class="logs">
                    <div>
                        <span class="highlight">June 28 2009 13:39:40</span>
                        static.sourceforge.net /css/phoneix/print.css?secure=0&20080417-1657 0.162620
                    </div>
                </div>
                <div class="description">
                    or to print  the string NoHostFound if the  %request.header.host cannot be valued
                </div>
                <div class="command_line">
                    justniffer -i eth0 -l "%request.timestamp %request.header.host<span class="highlight">(NoHostFound)</span>
                    %request.url %response.time"
                </div>
                <div class="logs">
                    <div>
                        06/28/09 15:10:28 www.google.com /ig?hl=en 0.116146
                    </div>
                    <div>
                        06/28/09 15:10:28 <span class="highlight">NoHostFound</span>
                        /ig?hl=en 0.116146
                    </div>
                </div>
                <div class="description">
                    many keywords	 have their own formatting string. A generic option (<b>-n</b>) can be used for setting a default "not found" string: a string that must replace the keyword if it cannot be valued. for example if request.header.[headername] is not found or if connection.time cannot be applicable.
					Anyway, if a "no found" string is provided as keyword parameter (for those that expect it), it will override the <b>-n</b> option 
                </div>
                <div class="command_line">
                    justniffer -i eth0 -l "%request.timestamp %request.header.host(NoHostFound) <span class="highlight">%request.header.host</span>
                    %request.url %response.time" <span class="highlight">-n N/A</span>
                </div>
                <div class="logs">
                    <div>
                        06/28/09 15:10:28 www.google.com <span class="highlight">www.google.com</span>
                        /ig?hl=en 0.116146
                    </div>
                    <div>
                        06/28/09 15:10:28 NoHostFound <span class="highlight">N/A</span>
                        /ig?hl=en 0.116146
                    </div>
                </div>
            </div>
            <div id="example7" class="example">
            	<h3>Example 7</h3>
                <div class="description">
                    the <b>-p</b>
                    option let you to specify a tcpdump compatibile filter:
                    "port 80 or port 8080" capture only http traffic (usually
                    using tcp port 80 and 8080)
                </div>
                <div class="command_line">
                    justniffer -i eth0 -r -p "port 80 or port 8080"
                </div>
            </div>
            <div id="example8" class="example">
            	<h3>Example 8</h3>
                <div class="description">
                    the <b>-e</b>
                    option let you to specify an external executable (usually a script) to which , <b>for every log</b>,  the output will be redirect to.
		    If you want to perform complex extraction operations, you can write your own script that will receive from the standard input all content specified by the 
		    <b>-l</b> option. A complete ad useful example is provided with <a href="justniffer-grab-http-traffic.html">justniffer-grab-http-traffic</a>
                
                </div>
                <div class="command_line">
                     ./justniffer  -l "%response" -e ./myscript.sh -i ath0
                </div>
		 <div class="logs"><div>
<pre>
#!/bin/bash
# myscript.sh 
# example script (print all lines containing "href" string)

while read inputline
do 
 anchors=`echo "$inputline" | grep href`
 if [ "$anchors" != "" ]; then
    echo $anchors;
 fi;
done
</pre>
</div></div>

            </div>
            <div id="example9"  class="example">
            	<h3>Example 9</h3>
                <div class="command_line">
                    justniffer -i eth0 -r -p "port 25"
                </div>
                <div class="description">
                    capture smtp traffic (usually using tcp port 25)
                </div>
                <div class="logs">
                    <div>
                        <pre>
220 plecno.com ESMTP Postfix (Ubuntu)

EHLO unknown.localnet
250-plecno.com       
250-PIPELINING       
250-SIZE             
250-VRFY             
250-ETRN             
250-STARTTLS         
250-ENHANCEDSTATUSCODES
250-8BITMIME           
250 DSN                

MAIL FROM:&lt;oreste.notelli@plecno.com&gt; SIZE=1079
RCPT TO:&lt;oreste.notelli@gmail.com&gt;             
DATA                                           
250 2.1.0 Ok                                   
250 2.1.5 Ok                                   
354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;            

From: Oreste Notelli &lt;oreste.notelli@plecno.com&gt;
Organization: Plecno
To: oreste.notelli@gmail.com
Subject: test
Date: Wed, 22 Apr 2009 22:46:16 +0200
User-Agent: KMail/1.11.2 (Linux/2.6.27-8-generic; KDE/4.2.2; i686; ; )
MIME-Version: 1.0
Content-Type: multipart/alternative;
  boundary="Boundary-00=_ZI47J3FTNXn+25g"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: &lt;200904222246.17292.oreste.notelli@plecno.com&gt;

--Boundary-00=_ZI47J3FTNXn+25g
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit

test

--Boundary-00=_ZI47J3FTNXn+25g
Content-Type: text/html;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta name="qrichtext" content="1" /&gt;
&lt;style type="text/css"&gt;p, li { white-space: pre-wrap; }&lt;/style&gt;
&lt;/head&gt;
&lt;body style=" font-family:'DejaVu Sans'; font-size:8pt; font-weight:400; font-style:normal;"&gt;
&lt;p&gt;
test
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
--Boundary-00=_ZI47J3FTNXn+25g--
.
250 2.0.0 Ok: queued as 33E7235C21A

QUIT
221 2.0.0 Bye

                                        
</pre>
                    </div>
                </div>
            </div>
            <div class="links">
                <a href="http://sourceforge.net"><img src= "http://sflogo.sourceforge.net/sflogo.php?group_id=205860&amp;type=2" width="125" height="37" border="0" alt= "SourceForge.net Logo" /></a>
	        	<img class="logo" src="./logoblue.png"/>
				<a class="menu" href="/">Home</a>
                <a class="menu" href="justniffer-grab-http-traffic.html">justniffer-grab-http-traffic</a>
                <a class="menu" href="man.htm">Look at the man page</a>
                <a class="menu" href="http://sourceforge.net/projects/justniffer/">Project
                    Summary
                    <sup>
                        <img src="./external.png"/>
                    </sup>
                </a><a class="menu" href= "http://sourceforge.net/project/platformdownload.php?group_id=205860&sel_platform=4737">Download
                    <sup>
                        <img src="./external.png"/>
                    </sup>
                </a>
                <g:plusone size="small" count="false" href="http://justniffer.sourceforge.net/" ></g:plusone>
                <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://justniffer.sourceforge.net/" data-count="none">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
                <a  title="bookmark on delicious" href="http://www.delicious.com/save" onclick="window.open('http://www.delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent('http://justniffer.sourceforge.net/')+'&title='+encodeURIComponent(document.title), 'delicious','toolbar=no,width=550,height=550'); return false;"><img src="http://l.yimg.com/hr/img/delicious.small.gif" height="10" width="10" alt="Delicious" /></a>
            </div>
        </div>
        <div id="copyright">
            <pre>
Copyright (c) 2007-2011 Plecno s.r.l. All Rights Reserved 
info@plecno.com
via Giovio 8, 20144 Milano, Italy
Released under the terms of the GPLv3 or later
Author: Oreste Notelli &lt; oreste.notelli at plecno.com &gt;

</pre>
        </div>
    </body>
</html>
